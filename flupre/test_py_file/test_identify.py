# !/usr/bin/python 
# -*- coding: utf-8 -*-
# Author:lihuiru
# Created on 2023/12/21 13:19
from collections import defaultdict
import re
use_protein = "H3"
markers = defaultdict(list)
expected_markers = {'HA1': ['156N', '225G', '132R', '184R', '178A', '178K', '144G', '208G', '131N', '158-', '186P', '172V', '243K', '90N', '304T', '246K', '204R', '148T', '172T', '214K', '126A', '215N', '147N', '184H', '146N', '218W', '209L', '299R', '81N', '228S', '156R', '340R', '211S', '313L', '138S', '175G', '186T', '161F', '263R', '208N', '180I', '204E', '186L', '218E', '190V', '83V', '212I', '62I', '127V', '176R', '304D', '215R', '222L', '158D', '98F', '98Y', '136S', '186V', '121D', '326V', '226L', '140Q', '131V', '131E', '148S', '214L', '354H', '255T', '103T', '144E', '181R', '222V', '193E', '202I', '116N', '178G', '263G', '186I', '138S', '26Q', '78P', '172P', '132G', '119S', '152T', '210E', '225E', '185K', '174K', '299R', '216S', '131L', '211V', '227S', '190S', '213W', '315I', '306I', '211V', '215N', '174D', '118R', '146D', '181R', '216S', '214L', '174K', '181S', '185K', '133S', '148A', '178D', '127V', '146S', '118P', '180I', '214E', '126A', '132R', '142V', '119I', '184R', '98Y', '178G', '124V', '212K', '236D', '175G', '72K', '147N', '205R', '141N', '115N', '209L', '169P'], 'HA2': ['46E', '79M', '66H', '101G', '114K', '81G', '119H', '64E', '47T', '-I', '158S', '111T', '107I', '105K', '90G', '117S', '65P', '156N']}
renumbered_position = [{'HA1': ['1Q', '2-', '3P', '4-', '5-', '6-', '7-', '8N', '9N', '10T', '11A', '12T', '13L', '14C', '15L', '16G', '17H', '18H', '19A', '20V', '21P', '22N', '23G', '24T', '25I', '26V', '27K', '28T', '29I', '30T', '31-', '32D', '33-', '34I', '35E', '36V', '37T', '38N', '39A', '40T', '41E', '42L', '43V', '44Q', '45-', '46S', '47S', '48-', '49G', '50-', '51I', '52C', '53-', '54-', '55P', '56H', '57-', '58I', '59L', '60D', '61G', '62-', '63-', '64C', '65T', '66L', '67-', '68D', '69A', '70L', '71L', '72G', '73D', '74P', '75-', '76C', '77D', '78-', '79F', '80Q', '81-', '82-', '83-', '84W', '85D', '86L', '87-', '88V', '89E', '90R', '91S', '92-', '93A', '94-', '95S', '96N', '97C', '98Y', '99P', '100Y', '101D', '102V', '103P', '104D', '105Y', '106A', '107S', '108L', '109R', '110S', '111L', '112V', '113A', '114S', '115S', '116G', '117T', '118L', '119E', '120F', '121-', '122-', '123E', '124-', '125F', '126-', '127W', '128T', '129G', '130V', '131T', '132Q', '133N', '134-', '135G', '136S', '137-', '138A', '139C', '140-', '141R', '142-', '143-', '144-', '145-', '146-', '147F', '148F', '149S', '150R', '151L', '152N', '153W', '154L', '155T', '156-', '157-', '158-', '159-', '160-', '161Y', '162P', '163-', '164L', '165N', '166V', '167T', '168M', '169P', '170-', '171-', '172-', '173N', '174F', '175D', '176K', '177L', '178Y', '179-', '180W', '181G', '182V', '183H', '184H', '185P', '186-', '187T', '188-', '189-', '190-', '191Q', '192-', '193-', '194L', '195Y', '196-', '197-', '198A', '199S', '200G', '201R', '202-', '203T', '204V', '205S', '206T', '207-', '208R', '209S', '210Q', '211Q', '212-', '213-', '214I', '215P', '216N', '217I', '218G', '219S', '220R', '221P', '222-', '223-', '224R', '225-', '226-', '227S', '228-', '229R', '230I', '231S', '232I', '233Y', '234W', '235T', '236I', '237V', '238K', '239P', '240G', '241D', '242I', '243L', '244-', '245I', '246N', '247S', '248-', '249G', '250N', '251L', '252I', '253A', '254P', '255R', '256G', '257Y', '258F', '259K', '260-', '261R', '262-', '263G', '264K', '265S', '266S', '267I', '268M', '269R', '270S', '271D', '272A', '273P', '274I', '275-', '276-', '277C', '278-', '279S', '280E', '281C', '282I', '283T', '284P', '285N', '286G', '287S', '288I', '289P', '290N', '291D', '292K', '293P', '294F', '295Q', '296N', '297V', '298N', '299-', '300I', '301T', '302Y', '303G', '304A', '305C', '306P', '307-', '308Y', '309V', '310K', '311-', '312S', '313T', '314L', '315K', '316L', '317A', '318T', '319G', '320M', '321R', '322N', '323V', '324P', '325E', '326K', '327Q', '328T', '329R']}, {'HA2': ['1-', '2L', '3F', '4G', '5A', '6I', '7A', '8G', '9F', '10I', '11E', '12N', '13G', '14W', '15E', '16G', '17M', '18I', '19D', '20G', '21W', '22Y', '23G', '24F', '25R', '26H', '27Q', '28N', '29S', '30E', '31G', '32-', '33G', '34Q', '35A', '36A', '37D', '38L', '39K', '40S', '41T', '42Q', '43A', '44A', '45I', '46D', '47Q', '48I', '49N', '50G', '51K', '52L', '53N', '54R', '55-', '56I', '57-', '58K', '59T', '60N', '61E', '62K', '63F', '64H', '65Q', '66I', '67E', '68K', '69E', '70F', '71S', '72E', '73V', '74E', '75G', '76R', '77-', '78Q', '79D', '80L', '81E', '82K', '83Y', '84V', '85E', '86D', '87T', '88K', '89I', '90D', '91L', '92W', '93S', '94Y', '95N', '96A', '97E', '98L', '99L', '100V', '101A', '102L', '103E', '104N', '105Q', '106H', '107T', '108I', '109D', '110L', '111T', '112D', '113S', '114E', '115M', '116N', '117K', '118L', '119F', '120E', '121K', '122T', '123-', '124-', '125Q', '126L', '127R', '128E', '129N', '130A', '131E', '132D', '133M', '134G', '135N', '136G', '137C', '138F', '139K', '140I', '141Y', '142H', '143K', '144C', '145D', '146N', '147A', '148C', '149I', '150-', '151S', '152I', '153R', '154N', '155-', '156T', '157Y', '158D', '159H', '160-', '161-', '162Y', '163R', '164D', '165E', '166A', '167L', '168N', '169N', '170R', '171F', '172Q', '173I', '174K', '175G', '176V', '177E', '178L', '179K', '180S', '181G', '182Y', '183K', '184D', '185W', '186I', '187L', '188W', '189I', '190S', '191F', '192A', '193I', '194S', '195C', '196F', '197L', '198L', '199C', '200-', '201V', '202L', '203L', '204G', '205F', '206I', '207M', '208W', '209A', '210C', '211Q', '212-', '213G', '214N', '215I', '216R', '217C', '218N', '219I', '220C', '221I']}]

if use_protein == "H3":
    for hatype, ha_markers in expected_markers.items():
        for marker in ha_markers:
            match = re.match(r"(\d+)([A-Z])", marker)
            index = 0 if hatype == "HA1" else 1
            if match and match.group() in renumbered_position[index][hatype]:
                markers[hatype].append(match.group())
print(markers)