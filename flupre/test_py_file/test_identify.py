# !/usr/bin/python 
# -*- coding: utf-8 -*-
# Author:lihuiru
# Created on 2023/12/21 13:19
from collections import defaultdict
import re
use_protein = "H3"
markers = defaultdict(list)
expected_markers = {'HA1': ['156N', '225G', '132R', '184R', '178A', '178K', '144G', '208G', '131N', '158-', '186P', '172V', '243K', '90N', '304T', '246K', '204R', '148T', '172T', '214K', '126A', '215N', '147N', '184H', '146N', '218W', '209L', '299R', '81N', '228S', '156R', '340R', '211S', '313L', '138S', '175G', '186T', '161F', '263R', '208N', '180I', '204E', '186L', '218E', '190V', '83V', '212I', '62I', '127V', '176R', '304D', '215R', '222L', '158D', '98F', '98Y', '136S', '186V', '121D', '326V', '226L', '140Q', '131V', '131E', '148S', '214L', '354H', '255T', '103T', '144E', '181R', '222V', '193E', '202I', '116N', '178G', '263G', '186I', '138S', '26Q', '78P', '172P', '132G', '119S', '152T', '210E', '225E', '185K', '174K', '299R', '216S', '131L', '211V', '227S', '190S', '213W', '315I', '306I', '211V', '215N', '174D', '118R', '146D', '181R', '216S', '214L', '174K', '181S', '185K', '133S', '148A', '178D', '127V', '146S', '118P', '180I', '214E', '126A', '132R', '142V', '119I', '184R', '98Y', '178G', '124V', '212K', '236D', '175G', '72K', '147N', '205R', '141N', '115N', '209L', '169P'], 'HA2': ['46E', '79M', '66H', '101G', '114K', '81G', '119H', '64E', '47T', '-I', '158S', '111T', '107I', '105K', '90G', '117S', '65P', '156N']}
renumbered_position = [{'HA1': ['1Q', '2-', '3P', '4-', '5-', '6-', '7-', '8N', '9N', '10T', '11A', '12T', '13L', '14C', '15L', '16G', '17H', '18H', '19A', '20V', '21P', '22N', '23G', '24T', '25I', '26V', '27K', '28T', '29I', '30T', '31-', '32D', '33-', '34I', '35E', '36V', '37T', '38N', '39A', '40T', '41E', '42L', '43V', '44Q', '45-', '46S', '47S', '48-', '49G', '50-', '51I', '52C', '53-', '54-', '55P', '56H', '57-', '58I', '59L', '60D', '61G', '62-', '63-', '64C', '65T', '66L', '67-', '68D', '69A', '70L', '71L', '72G', '73D', '74P', '75-', '76C', '77D', '78-', '79F', '80Q', '81-', '82-', '83-', '84W', '85D', '86L', '87-', '88V', '89E', '90R', '91S', '92-', '93A', '94-', '95S', '96N', '97C', '98Y', '99P', '100Y', '101D', '102V', '103P', '104D', '105Y', '106A', '107S', '108L', '109R', '110S', '111L', '112V', '113A', '114S', '115S', '116G', '117T', '118L', '119E', '120F', '121-', '122-', '123E', '124-', '125F', '126-', '127W', '128T', '129G', '130V', '131T', '132Q', '133N', '134-', '135G', '136S', '137-', '138A', '139C', '140-', '141R', '142-', '143-', '144-', '145-', '146-', '147F', '148F', '149S', '150R', '151L', '152N', '153W', '154L', '155T', '156-', '157-', '158-', '159-', '160-', '161Y', '162P', '163-', '164L', '165N', '166V', '167T', '168M', '169P', '170-', '171-', '172-', '173N', '174F', '175D', '176K', '177L', '178Y', '179-', '180W', '181G', '182V', '183H', '184H', '185P', '186-', '187T', '188-', '189-', '190-', '191Q', '192-', '193-', '194L', '195Y', '196-', '197-', '198A', '199S', '200G', '201R', '202-', '203T', '204V', '205S', '206T', '207-', '208R', '209S', '210Q', '211Q', '212-', '213-', '214I', '215P', '216N', '217I', '218G', '219S', '220R', '221P', '222-', '223-', '224R', '225-', '226-', '227S', '228-', '229R', '230I', '231S', '232I', '233Y', '234W', '235T', '236I', '237V', '238K', '239P', '240G', '241D', '242I', '243L', '244-', '245I', '246N', '247S', '248-', '249G', '250N', '251L', '252I', '253A', '254P', '255R', '256G', '257Y', '258F', '259K', '260-', '261R', '262-', '263G', '264K', '265S', '266S', '267I', '268M', '269R', '270S', '271D', '272A', '273P', '274I', '275-', '276-', '277C', '278-', '279S', '280E', '281C', '282I', '283T', '284P', '285N', '286G', '287S', '288I', '289P', '290N', '291D', '292K', '293P', '294F', '295Q', '296N', '297V', '298N', '299-', '300I', '301T', '302Y', '303G', '304A', '305C', '306P', '307-', '308Y', '309V', '310K', '311-', '312S', '313T', '314L', '315K', '316L', '317A', '318T', '319G', '320M', '321R', '322N', '323V', '324P', '325E', '326K', '327Q', '328T', '329R']}, {'HA2': ['1-', '2L', '3F', '4G', '5A', '6I', '7A', '8G', '9F', '10I', '11E', '12N', '13G', '14W', '15E', '16G', '17M', '18I', '19D', '20G', '21W', '22Y', '23G', '24F', '25R', '26H', '27Q', '28N', '29S', '30E', '31G', '32-', '33G', '34Q', '35A', '36A', '37D', '38L', '39K', '40S', '41T', '42Q', '43A', '44A', '45I', '46D', '47Q', '48I', '49N', '50G', '51K', '52L', '53N', '54R', '55-', '56I', '57-', '58K', '59T', '60N', '61E', '62K', '63F', '64H', '65Q', '66I', '67E', '68K', '69E', '70F', '71S', '72E', '73V', '74E', '75G', '76R', '77-', '78Q', '79D', '80L', '81E', '82K', '83Y', '84V', '85E', '86D', '87T', '88K', '89I', '90D', '91L', '92W', '93S', '94Y', '95N', '96A', '97E', '98L', '99L', '100V', '101A', '102L', '103E', '104N', '105Q', '106H', '107T', '108I', '109D', '110L', '111T', '112D', '113S', '114E', '115M', '116N', '117K', '118L', '119F', '120E', '121K', '122T', '123-', '124-', '125Q', '126L', '127R', '128E', '129N', '130A', '131E', '132D', '133M', '134G', '135N', '136G', '137C', '138F', '139K', '140I', '141Y', '142H', '143K', '144C', '145D', '146N', '147A', '148C', '149I', '150-', '151S', '152I', '153R', '154N', '155-', '156T', '157Y', '158D', '159H', '160-', '161-', '162Y', '163R', '164D', '165E', '166A', '167L', '168N', '169N', '170R', '171F', '172Q', '173I', '174K', '175G', '176V', '177E', '178L', '179K', '180S', '181G', '182Y', '183K', '184D', '185W', '186I', '187L', '188W', '189I', '190S', '191F', '192A', '193I', '194S', '195C', '196F', '197L', '198L', '199C', '200-', '201V', '202L', '203L', '204G', '205F', '206I', '207M', '208W', '209A', '210C', '211Q', '212-', '213G', '214N', '215I', '216R', '217C', '218N', '219I', '220C', '221I']}]

if use_protein == "H3":
    for hatype, ha_markers in expected_markers.items():
        for marker in ha_markers:
            match = re.match(r"(\d+)([A-Z])", marker)
            index = 0 if hatype == "HA1" else 1
            if match and match.group() in renumbered_position[index][hatype]:
                markers[hatype].append(match.group())
print(markers)
# expet:
# {'HA2': ['119H', '66H', '156N', '114K', '107I', '46E', '158S', '111T', '101G', '47T', '79M', '90G', '64E', '81G', '-I', '117S', '65P', '105K'], 'None': ['144E', '156N', '218E', '144G', '263R', '225E', '212I', '354H', '186T', '81N', '161F', '299R', '156R', '193E', '225G', '304T', '228S', '226L', '138S', '246K', '158-', '62I', '186P', '131E', '98F', '186V', '263G', '222V', '340R', '186I', '190V', '78P', '326V', '186L', '222L'], 'HA1': ['184R', '213W', '172T', '152T', '127V', '215N', '181R', '190S', '147N', '121D', '304D', '138S', '211S', '208N', '119S', '90N', '313L', '185K', '227S', '176R', '180I', '148S', '211V', '214K', '172P', '126A', '146N', '98Y', '178K', '26Q', '172V', '299R', '174K', '208G', '132R', '255T', '216S', '131N', '136S', '210E', '116N', '132G', '175G', '202I', '140Q', '218W', '214L', '204E', '131V', '131L', '178G', '204R', '158D', '83V', '178A', '209L', '243K', '184H', '215R', '148T', '103T', '315I', '214E', '181S', '119I', '212K', '146S', '185K', '178G', '215N', '180I', '147N', '181R', '174K', '146D', '174D', '118R', '178D', '126A', '132R', '133S', '98Y', '306I', '124V', '184R', '211V', '236D', '175G', '214L', '127V', '148A', '142V', '216S', '118P', '72K', '141N', '115N', '205R', '169P', '209L']}
# renumber:
# [{'HA1': ['11D', '12T', '13-', '14C', '15-', '16G', '17Y', '18H', '19A', '20N', '21N', '22S', '23T', '24D', '25T', '26V', '27D', '28T', '30V', '31L', '32E', '33K', '34N', '35V', '-T', '36V', '37T', '38H', '39S', '40-', '41N', '42L', '43L', '44E', '45D', '46-', '47H', '48N', '49G', '50K', '51L', '52C', '53-', '54L', '--', '55G', '56-', '57A', '58P', '59L', '60-', '61L', '62G', '63K', '64C', '65N', '66-', '67A', '68G', '69W', '70-', '71L', '72G', '73N', '74P', '75E', '76C', '77-', '78-', '79-', '80L', '81T', '82A', '83-', '-S', '84W', '85S', '86Y', '87-', '88I', '89E', '90-', '91T', '92N', '93S', '94-', '95N', '96G', '-T', '97C', '98Y', '99P', '100G', '101-', '102F', '103I', '104-', '105Y', '106E', '107E', '108L', '109R', '110E', '111Q', '112L', '113S', '114S', '115V', '116S', '117S', '118F', '119E', '120-', '121F', '122-', '123I', '124F', '125P', '-K', '--', '-S', '126S', '127W', '128P', '129-', '130H', '131-', '132-', '133-', '--', '134G', '135V', '136T', '137A', '138A', '139C', '140-', '141-', '142-', '143-', '144G', '145-', '146S', '147F', '148Y', '149-', '150N', '151-', '152L', '153-', '154-', '155I', '156K', '157K', '158G', '159-', '160S', '161Y', '162P', '163K', '164I', '165-', '166-', '167T', '168Y', '169-', '170-', '171N', '172K', '173G', '174K', '175E', '176V', '177L', '178V', '179L', '180W', '181G', '182-', '183H', '184H', '185P', '186P', '187-', '188-', '189D', '190-', '191Q', '192Q', '193-', '194L', '195Y', '196Q', '197-', '198-', '199N', '200A', '201Y', '202V', '203-', '204V', '205G', '206S', '207S', '208K', '209-', '210-', '211-', '212-', '213F', '214-', '215P', '216E', '217-', '218-', '219A', '220R', '221P', '222K', '223V', '224R', '225-', '226Q', '227-', '228G', '229R', '230-', '231N', '232Y', '233Y', '234W', '235T', '236-', '237L', '238E', '239-', '240G', '241D', '242-', '243I', '244T', '245F', '246E', '247A', '248T', '249G', '250N', '251L', '252-', '253A', '254P', '255-', '256Y', '257A', '258F', '259A', '260-', '261-', '262-', '263-', '264-', '-G', '265S', '266G', '267I', '268I', '269-', '270S', '271D', '272T', '273P', '274V', '275H', '276-', '277-', '278D', '279T', '280-', '281C', '282Q', '283T', '284P', '285-', '286G', '287A', '288-', '289N', '290-', '291S', '292L', '293P', '294F', '295Q', '296N', '297V', '298H', '299P', '300I', '301T', '302I', '303G', '304-', '305C', '306P', '307K', '308Y', '309V', '310K', '311-', '312T', '313K', '314L', '315R', '316M', '317A', '318T', '319G', '320L', '321R', '322N', '323V', '324P', '325S', '326I']}, {'HA2': ['1-', '2L', '3F', '4G', '5A', '6I', '7A', '8G', '9F', '10I', '11E', '12G', '13G', '14W', '15T', '16G', '17M', '18I', '19D', '20G', '21W', '22Y', '23G', '24Y', '25H', '26H', '27Q', '28N', '29E', '30Q', '31G', '32S', '33G', '34Y', '35A', '36A', '37D', '38-', '39K', '40S', '41T', '42Q', '43-', '44A', '45I', '46D', '47-', '48I', '49T', '50N', '51K', '52V', '53N', '54S', '55V', '56I', '57E', '58K', '59M', '60N', '61T', '62Q', '63F', '64T', '65A', '66V', '67G', '68K', '69E', '70F', '71-', '72N', '73L', '74E', '75K', '76R', '77I', '78E', '79N', '80L', '81N', '82K', '83K', '84V', '85D', '86D', '87G', '88F', '89L', '90D', '91-', '92W', '93T', '94Y', '95N', '96A', '97E', '98L', '99L', '100V', '101L', '102L', '103E', '104N', '105E', '106R', '107T', '108L', '109D', '110-', '111H', '112D', '113S', '114N', '115V', '116-', '117N', '118L', '119Y', '120E', '121K', '122V', '123R', '124-', '125Q', '126L', '127-', '128N', '129N', '130A', '131K', '132E', '133I', '134G', '135N', '136G', '137C', '138F', '139E', '140F', '141Y', '142H', '143K', '144C', '145-', '146D', '147-', '148C', '149M', '150E', '151S', '152V', '153K', '154N', '155G', '156T', '157Y', '158D', '159Y', '160P']}]